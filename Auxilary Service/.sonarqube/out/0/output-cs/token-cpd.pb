Œ)
uD:\University of Oulu\Courses\Programable Web Project\Project\pwp-project-video-streaming\Auxilary Service\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddHttpClient 
( 
)  
;  !
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder		 
.		 
Services		 
.		 
AddSwaggerGen		 
(		 
c		  
=>		! #
{

 
c 
. 

SwaggerDoc 
( 
$str 
, 
new 
	Microsoft $
.$ %
OpenApi% ,
., -
Models- 3
.3 4
OpenApiInfo4 ?
{ 
Title 
= 
$str 
, 
Version 
= 
$str 
} 
) 
; 
} 
) 
; 
builder 
. 
Services 
. 
AddCors 
( 
options  
=>! #
{ 
options 
. 
	AddPolicy 
( 
$str '
,' (
builder 
=> 
{ 	
builder 
. 
AllowAnyOrigin "
(" #
)# $
. 
AllowAnyMethod 
(  
)  !
. 
AllowAnyHeader 
(  
)  !
;! "
} 	
)	 

;
 
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if!! 
(!! 
app!! 
.!! 
Environment!! 
.!! 
IsDevelopment!! !
(!!! "
)!!" #
)!!# $
{"" 
app## 
.## %
UseDeveloperExceptionPage## !
(##! "
)##" #
;### $
app%% 
.%% 

UseSwagger%% 
(%% 
)%% 
;%% 
app&& 
.&& 
UseSwaggerUI&& 
(&& 
c&& 
=>&& 
{'' 
c)) 	
.))	 

SwaggerEndpoint))
 
()) 
$str)) 4
,))4 5
$str))6 A
)))A B
;))B C
c** 	
.**	 

RoutePrefix**
 
=** 
string** 
.** 
Empty** $
;**$ %
}++ 
)++ 
;++ 
app.. 
... 
MapGet.. 
(.. 
$str.. )
,..) *
async..+ 0
context..1 8
=>..9 ;
{// 
var00 
yamlFilePath00 
=00 
Path00 
.00  
Combine00  '
(00' (

AppContext00( 2
.002 3
BaseDirectory003 @
,00@ A
$str00B K
,00K L
$str00M [
)00[ \
;00\ ]
if11 

(11 
File11 
.11 
Exists11 
(11 
yamlFilePath11 $
)11$ %
)11% &
{22 	
var33 
yamlContent33 
=33 
await33 #
File33$ (
.33( )
ReadAllTextAsync33) 9
(339 :
yamlFilePath33: F
)33F G
;33G H
context44 
.44 
Response44 
.44 
ContentType44 (
=44) *
$str44+ ?
;44? @
await55 
context55 
.55 
Response55 "
.55" #

WriteAsync55# -
(55- .
yamlContent55. 9
)559 :
;55: ;
}66 	
else77 
{88 	
context99 
.99 
Response99 
.99 

StatusCode99 '
=99( )
StatusCodes99* 5
.995 6
Status404NotFound996 G
;99G H
await:: 
context:: 
.:: 
Response:: "
.::" #

WriteAsync::# -
(::- .
$str::. C
)::C D
;::D E
};; 	
}<< 
)<< 
;<< 
}== 
app@@ 
.@@ 
UseCors@@ 
(@@ 
$str@@ 
)@@ 
;@@ 
appBB 
.BB 
UseHttpsRedirectionBB 
(BB 
)BB 
;BB 
appCC 
.CC 
UseAuthorizationCC 
(CC 
)CC 
;CC 
appEE 
.EE 
MapControllersEE 
(EE 
)EE 
;EE 
awaitGG 
appGG 	
.GG	 

RunAsyncGG
 
(GG 
)GG 
;GG ¹
}D:\University of Oulu\Courses\Programable Web Project\Project\pwp-project-video-streaming\Auxilary Service\WeatherForecast.cs
	namespace 	
Auxilary_Service
 
{ 
public 

class 
	VideosDto 
{ 
public 
string 
? 
Id 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
? 
VideoId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Tags 
{ 
get !
;! "
set# &
;& '
}( )
public

 
string

 
?

 
Description

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 
string 
? 
Url 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
? 
VideoStatus 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
VideoUploadedDate *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
bool 
isVoted 
{ 
get !
;! "
set# &
;& '
}( )
public 
bool 
isBookmarked  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
thumbnailUrl #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} Ì
“D:\University of Oulu\Courses\Programable Web Project\Project\pwp-project-video-streaming\Auxilary Service\Controllers\AuxilaryServiceController.cs
	namespace 	
Auxilary_Service
 
. 
Controllers &
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class %
AuxilaryServiceController *
:+ ,
ControllerBase- ;
{		 
private 
readonly 

HttpClient #
_httpClient$ /
;/ 0
private 
readonly 
string 

baseAPIUrl  *
=+ ,
$str- E
;E F
public %
AuxilaryServiceController (
(( )

HttpClient) 3

httpClient4 >
)> ?
{ 	
_httpClient 
= 

httpClient $
;$ %
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (!
GenerateThumbnailById) >
(> ?
string? E
videoIdF M
)M N
{ 	
try 
{ 
HttpResponseMessage #
response$ ,
=- .
await/ 4
_httpClient5 @
.@ A
GetAsyncA I
(I J
$"J L
{L M

baseAPIUrlM W
}W X
$strX _
{_ `
videoId` g
}g h
"h i
)i j
;j k
response   
.   #
EnsureSuccessStatusCode   0
(  0 1
)  1 2
;  2 3
string"" 
responseBody"" #
=""$ %
await""& +
response"", 4
.""4 5
Content""5 <
.""< =
ReadAsStringAsync""= N
(""N O
)""O P
;""P Q
using%% 
(%% 
JsonDocument%% #
doc%%$ '
=%%( )
JsonDocument%%* 6
.%%6 7
Parse%%7 <
(%%< =
responseBody%%= I
)%%I J
)%%J K
{&& 
JsonElement'' 
dataElement''  +
='', -
doc''. 1
.''1 2
RootElement''2 =
.''= >
GetProperty''> I
(''I J
$str''J P
)''P Q
;''Q R
var(( 
dataJson((  
=((! "
dataElement((# .
.((. /

GetRawText((/ 9
(((9 :
)((: ;
;((; <
	VideosDto++ 
?++ 
	videoData++ (
=++) *
JsonSerializer+++ 9
.++9 :
Deserialize++: E
<++E F
	VideosDto++F O
>++O P
(++P Q
dataJson++Q Y
,++Y Z
new++[ ^!
JsonSerializerOptions++_ t
{,, '
PropertyNameCaseInsensitive-- 3
=--4 5
true--6 :
}.. 
).. 
;.. 
if11 
(11 
	videoData11 !
!=11" $
null11% )
)11) *
{22 
	videoData33 !
.33! "
thumbnailUrl33" .
=33/ 0
$"44 
$str44 @
{44@ A
	videoData44A J
.44J K
VideoId44K R
}44R S
$str44S a
"44a b
;44b c
return66 
Ok66 !
(66! "
	videoData66" +
)66+ ,
;66, -
}77 
return99 
NotFound99 #
(99# $
$str99$ 7
)997 8
;998 9
}:: 
}<< 
catch== 
(== 
	Exception== 
e== 
)== 
{>> 
Console?? 
.?? 
	WriteLine?? !
(??! "
e??" #
)??# $
;??$ %
throw@@ 
;@@ 
}AA 
}CC 	
}DD 
}EE 